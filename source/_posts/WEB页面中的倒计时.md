---
title: WEB页面中的倒计时
date: 2016-02-28
tags: 
---
> ​	在工作中用了倒计时的功能，今天来简单分享一下；

## 倒计时几种方式

1. 客户端倒计时
2. Ajax轮询取服务器时间倒计时
3. 其他！！！

​	客户端倒计时只有用户的PC或者手机调整一下时间那么起码从显示上就出了问题，所以客户端倒计时肯定不行。

​	服务器倒计时要在网页当中显示，我们需要定时去向服务器端轮询，这种方式显然也不行，或者获取一次通过setInterval去倒计时，这里每个设备的CUP 效率不同，所以每次调用setInterval都会相差x毫秒，所以当我们倒计时时间比较长的时候就会发现不同设备的值竟然出现了不一样；

​	重点在于【其他！！！】，哈哈，这里的做法是这样：

1. Ajax获取服务器时间；
2. 与客户端时间进行比较差值diff，即便CPU的效率不同，但是客户端时间与服务器时间的差值是恒定的，除非客户端获取服务器时间后再次修改；
3. 倒计时的时候获取客户端的时间加上刚刚获取差值diff，这样就得到了服务器的时间；

​	很多文章是从请求的Header中获取服务器的Date字段，这里需要注意一下，如果获取的是静态资源的Header有可能会出问题，当静态服务器的时间与应用服务器时间不等会出现不一致，当静态资源配置了过期时间或者使用了CDN那么获取的时间是不正确的。

​	今天就分享到这里，欢迎各位看官批评指正！